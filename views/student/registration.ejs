<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Student Registration</title>
    <link rel="stylesheet" href="/public/css/tailwind.css" />
    <link rel="stylesheet" href="/public/css-fontawesome/all.min.css" />
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.google.com/recaptcha/api.js" async></script>
    <script src="/public/js/loadHeaderFooter.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        document
          .getElementById('rollno')
          .addEventListener('input', function () {
            this.value = this.value.toUpperCase();
          });
      });
      function confirmMe(event) {
        return confirm(
          'Please confirm your details:\nRoll No: ' +
            document.getElementById('rollno').value +
            '\nDOB: ' +
            document.getElementById('dob').value
        );
      }
    </script>
  </head>
  <body class="bg-gray-100 font-sans min-h-screen flex flex-col">
    <div id="header"></div>

    <main class="flex-grow flex justify-center items-center p-4">
      <div
        class="bg-white rounded-xl shadow-lg p-8 w-full max-w-md border-t-4 border-blue-600"
      >
        <h2 class="text-2xl font-bold text-gray-800 text-center mb-6">
          Student Registration
        </h2>

        <% if (typeof error !== 'undefined') { %>
        <div
          class="bg-red-100 border-l-4 border-red-500 text-red-700 p-3 mb-4 rounded flex justify-between"
        >
          <span
            ><%= error === 'exists' ? 'Student already exists.' : error %></span
          >
        </div>
        <% } %>

        <form
          action="/student/registration"
          method="POST"
          onsubmit="return confirmMe(event)"
          class="space-y-5"
        >
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1"
              >Roll Number</label
            >
            <input
              type="text"
              name="rollno"
              id="rollno"
              pattern="\d{3}[A-Z]{3}\d{4}"
              title="Format: 121CSE2024"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
              placeholder="e.g. 101ITE2023"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1"
              >Date of Birth (DD-MM-YYYY)</label
            >
            <input
              type="text"
              name="dob"
              id="dob"
              pattern="\d{2}-\d{2}-\d{4}"
              placeholder="DD-MM-YYYY"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
            />
            <p class="text-xs text-gray-500 mt-1">
              This will be your initial password.
            </p>
          </div>

          <div class="flex justify-center my-4">
            <div
              class="g-recaptcha"
              data-sitekey="6Ld6vGkrAAAAAMMaX4NtFTIDSFi4g2MUtg83lbud"
            ></div>
          </div>

          <button
            type="submit"
            class="w-full bg-blue-600 text-white font-bold py-2.5 rounded-lg hover:bg-blue-700 transition shadow"
          >
            <i class="fa-solid fa-user-plus mr-2"></i> Register
          </button>
        </form>

        <div class="mt-4 text-center text-sm">
          <a
            href="/student/login"
            class="text-blue-600 hover:underline font-medium"
            >Already registered? Login</a
          >
        </div>
      </div>
    </main>
  </body>
  <script>
    // Formatting DOB automatically
    document.getElementById('dob').addEventListener('input', function (e) {
      let v = e.target.value.replace(/\D/g, '');
      if (v.length >= 2) v = v.slice(0, 2) + '-' + v.slice(2);
      if (v.length >= 5) v = v.slice(0, 5) + '-' + v.slice(5, 9);
      e.target.value = v;
    });
  </script>
</html>
